# Finding Public Exploits

One of the most essential skills during an assessment is knowing how to find public exploits. All the way from CTF machines to real-world machines. In this page you'll learn a few of the most common techniques or methods used to find public exploits. There are a-lot of ways in which we can start, I'm going to divide this into services and web-applications.

## Warning

There are a-lot of trolls on the internet, make sure that you read and understand every single line of code in a exploit before executing it.

## Finding Service Exploits



### Banners/Service Information

Banners can reveal information about the service, like its name and its version. You can use tools like nmap or netcat to enumerate banners.

You can use the nmap `-sV` option to enumerate service information, use `-sT` for TCP ports:

```
sudo nmap -sT -p <PORT> -sV <IP>
```

You can use the nmap `-sV` option to enumerate service information, use `-sU` for UDP ports:

```
sudo nmap -sU -p <PORT> -sV <IP>
```

Enumerate banners with netcat for TCP ports

```
nc -nv <IP> <PORT>
```

Enumerate banners with netcat for UDP ports:

```
nc -nv -u <IP> <PORT>
```

Once you find the name and/or version of the service, you can start searching for exploits:

{% embed url="https://nozerobit.gitbook.io/hacknotes/exploitation/searching-for-exploits" %}

### Vulnerability Scanning

You can use vulnerability scanners to find vulnerabilities and from the results you can start searching for exploits.

#### Nmap NSE Scripts

Nmap has vulnerability scripts and exploit scripts that you can use to find exploits.&#x20;

Nmap scripts location:

```
/usr/share/nmap/scripts/
```

Nmap scripts database:

```
/usr/share/nmap/scripts/script.db
```

Filter the vulnerability scripts and the exploit scripts defined in the categories:

```
cat /usr/share/nmap/scripts/script.db | grep '"vuln"\|"exploit"'
```

Run all scripts in the `vuln` category against a target:

```
sudo nmap --script vuln 10.10.10.11
```

#### Nessus

You can use Nessus to scan a target or multiple targets and is heavily used in the industry:

{% embed url="https://www.tenable.com/products/nessus" %}

## Finding Web App Exploits



### Information Disclosure

Web applications may reveal their name and version. Let's take for example, phpLiteAdmin, if you find the name and the version you can start searching for exploits:

{% embed url="https://nozerobit.gitbook.io/hacknotes/exploitation/searching-for-exploits" %}

### Page Source Code

The page source code can reveal the application name, filenames, domains, virtual hosting, and some comments may reveal problems or hints. You will rarely find interesting information on the page source code in the real-world but in CTF machines you may find fun stuff like credentials, hints, filenames, and sensitive files.

Keyboard Shortcuts:

* Windows/Linux: Ctrl + U
* Mac: Command + U

### Inspecting URLs

File extensions can be a hint to the programming language that the application use:

Java:

```
.jsp
.do
.jar
.html
```

PHP:

```
.php
.phtml
.php3
.php4
.php5
.phps
```

ASP:

```
.asp
.aspx
```

ASP.NET Razor:

```
.cshtml
```

However, because many languages and frameworks now offer the concept of routes, which allows developers to map a URI to a chunk of code, file extensions on web pages are becoming less prevalent. Route-based applications utilize logic to determine which content is returned to the user.

### Inspecting Page Content

The `source` of the web page contains the majority of context clues.

#### Developer Tools - Debugger

The developers often tend to minified the code, which makes it more compact and conserving resources but it is somewhat difficult to read. Fortunately, we can use the “prettify” code by clicking on the Pretty print source button with the double curly braces `{}`:

\-> screenshot here

#### Developer Tools - Inspector

Select a field then right-click and now select the `Inspect Element`.

Let’s use Inspector to examine an input element from the page by right-clicking the field on the page and selecting Inspect Element or using the shortcut `Page Up`.

#### Developer Tools - Network

The network tool can reveal `domain addresses` or `virtual hosting` of where the files are linked.

#### Developer Tools - Storage

The storage tool can reveal cookies and tokens. Cookie names or variables can reveal the type of programming language the web application is using.

### Viewing Response Headers

HTTP Headers can reveal technologies and from there you can search for exploits, yes using the headers names and values. I have faced many machines where I have found the exploit by enumerating the response headers of each page and each port that's hosting a website or webapp.

#### Interesting Headers

The names or values often reveal additional information about the technology stack used by the application.

> Note: Headers that start with `X-` are non-standard HTTP headers.

\-> Table here

You can use `curl` to find response headers:

```
curl -v <IP>
curl -I <IP>
```

You can also use `whatweb` to enumerate headers:

```
whatweb -v <IP>
```

Alternatively, you can use proxies like `Burp Suite` to **intercept server responses** to see the response headers.

#### Developer Tools - Network

The network tool can reveal `domain addresses` or `virtual hosting` of where the files are linked and we can also view HTTP `requests` and `responses`.

### Inspecting Sitemaps

Sitemap files can be included in web applications to assist search engine bots in crawling and indexing their sites. These files also contain directives indicating which URLs should not be crawled. These are frequently sensitive pages or administrative consoles, which is exactly what we're looking for.

The two most typical sitemap filenames are `robots.txt` and `sitemap.xml`.

\-> Sitemaps table here

### Locating Administration Consoles

Web servers often have remote administration web applications, or consoles, which are accessible via a **particular URL** and they are often **listening on a specific TCP port**.

Common Administration Consoles:

* Tomcat: **/manager/html**
* phpMyAdmin: **/phpmyadmin**
* Adminer: **/adminer**
* phpLiteAdmin: **/db**
* SpringSource: **/admin**
* Oracle: **/console**

These consoles can be restricted to localhost or may be hosted on **custom TCP ports**, however, by default they are exposed by **default configurations**.

Regardless, we should verify the **default console locations**, which are identified in the application server **software documentation**.

After locating the administration console and identified its version, you can start searching for exploits:

{% embed url="https://nozerobit.gitbook.io/hacknotes/exploitation/searching-for-exploits" %}



