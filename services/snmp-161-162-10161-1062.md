# SNMP - 161,162,10161,1062

## SNMP MIB

MIB xyz

| MIB Values             | Windows Parameters |
| ---------------------- | ------------------ |
| 1.3.6.1.2.1.25.1.6.0   | System Processes   |
| 1.3.6.1.2.1.25.4.2.1.2 | Running Programs   |
| 1.3.6.1.2.1.25.4.2.1.4 | Processes Path     |
| 1.3.6.1.2.1.25.2.3.1.4 | Storage Units      |
| 1.3.6.1.2.1.25.6.3.1.2 | Software Name      |
| 1.3.6.1.4.1.77.1.2.25  | User Accounts      |
| 1.3.6.1.2.1.6.13.1.3   | TCP Local Ports    |

## SNMP Enumeration

### snmpcheck

We can check for SNMP with:

```
sudo snmpcheck <IP>
```

### onesixtyone

Bruteforce community strings:

```
# echo public > community
# echo private >> community
# echo manager >> community
onesixtyone -c community -i <IP>
```

### snmapwalk

Enumerate the public community string with MIBs:

```
snmpwalk -c public -v1 <IP>
snmpwalk -c public -v2c <IP>
snmpwalk -Os -c public -v 1 10.10.10.20
```

Enumerate with a specific MIB value:

```
snmpwalk -c public -v1 <IP> <MIB_Value>
snmpwalk -c public -v2c <IP> <MIB_Value>
```

## Usage Scenario

You can try to find community strings with onesixtyone using the `-c` parameter and a wordlist:

```
onesixtyone 10.10.140.97 -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt
```

![](../.gitbook/assets/onesixtyone-community-string-enumeration.png)

As you can see above `onesixtyone` has identified the community string 'openview'. We can then run this with snmp-check to dump all available SNMP information.

```
snmp-check -c openview 10.10.140.97
```

Looking through the results we find a non default username.

![](../.gitbook/assets/snmp-check-example.png)
