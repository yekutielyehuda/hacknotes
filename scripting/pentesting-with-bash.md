# Pentesting with Bash

## Special Variables

Common Special Variable names:

```text
$0 = the name of the bash script
$1 - $9 = the first nine arguments
$# = the number of arguments passed 
$@ = all arguments passed
$? = the exit status of the previous command
$$ = the process id of the current script
$USER = the name of the user running the script
$HOSTNAME = hostname
$RANDOM = a random number
$LINENO = the current line of the script
```

## Read User Input

read

```text
read $variable
```

Nice flags:

* -p = specify a prompt
* -s = silent user input \(hide text, is like when you are typing a password from the terminal, you can't see it\)

## Help 

A simple help menu can be made like this:

```bash
usage="$(basename "$0") [-h] [-s n] -- program description here.

where:
    -h  show this help text
    -s  set the seed value (default: 50)"

seed=50

while getopts ':hs:' option; do
  case "$option" in
    h) echo "$usage"
       exit
       ;;
    s) seed=$OPTARG
       ;;
    :) printf "missing argument for -%s\n" "$OPTARG" >&2
       echo "$usage" >&2
       exit 1
       ;;
   \?) printf "illegal option: -%s\n" "$OPTARG" >&2
       echo "$usage" >&2
       exit 1
       ;;
  esac
done

shift $((OPTIND - 1))
```

To use this inside a function:

* use `"$FUNCNAME"` instead of `$(basename "$0")`
* add `local OPTIND OPTARG` before calling `getopts`

If the first argument to a shell script is available as the variable `$1`, the simplest implementation would be:

```bash
if [ "$1" == "-h" ]; then
  echo "Usage: `basename $0` [somestuff]"
  exit 0
fi
```

The examples above were extracted from here:

{% embed url="https://stackoverflow.com/questions/5474732/how-can-i-add-a-help-method-to-a-shell-script" %}

## Ping Sweeps 

Ping sweeps one-liners:

```bash
for i in {1..255}; do (ping -c 1 172.18.0.$i > /dev/null && echo "172.18.0.$i is up" &); done
for i in `seq 1 255`; do (ping -c 1 172.18.0.$i > /dev/null && echo "172.18.0.$i is up" &); done
```

## Port Scans

Port scans one-liners:

```bash
for i in {1..65535}; do (echo > /dev/tcp/172.18.0.2/$i > /dev/null && echo "the port $i is open" &); done 2>/dev/null
for i in `seq 1 65535`; do (echo > /dev/tcp/172.18.0.2/$i > /dev/null && echo "the port $i is open" &); done 2>/dev/null
```

## Generate Wordlists

Generate a sequence list:

```bash
for i in $(seq 1 1000); do echo $i >> ids.txt; done
```

## Generate Passwords

We can use `tr` to generate passwords:

```bash
tr -dc 'A-Za-z0-9!"#$%&'\''()*+,-./:;<=>?@[\]^_`{|}~' </dev/urandom | head -c 50  ; echo
```

